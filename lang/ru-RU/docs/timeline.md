### Временная шкала

Временная шкала расположена снизу вверх. Самые верхние события - самые последние.

---
*2023-06-09 07:48 UTC*

Создатели Stage3b (skyrage), очевидно, потеряли свой домен skyrage.de (записи сервера имен и регистратора изменились, записи dns исчезли).

---
*2023-06-08 10:50 UTC*

Текущие C&C сервера stage3b (skyrage) `95[.].214.27.172` и `171[.]22.30.117` больше не доступны. Следим за возможными изменениями DNS.

Время - когда это было замечено, а не когда это произошло.

---
*2023-06-08 05:11 UTC*

Prospector объявляет следующее:

> Обновление от Modrinth, все файлы, загруженные за последние 10 месяцев...
> (примерно половина наших файлов) были просканированы и ни один зараженный
> файл не был найден.

---
*2023-06-08 01:12 UTC*

Все в основном снова успокоилось, вирусные сканеры начали определять файлы стадии 1+
jar-файлы как вредоносные, и на следующее утро в США запланирована встреча для обсуждения дальнейших шагов.

Встреча будет полуприватной, но записи/протоколы будут выложены после.

CurseForge сканирует все моды, но этот процесс все еще продолжается.

---
*2023-06-07 18:51 UTC*

Второй C&C сервер 107[.]189.3.101 был приостановлен хостинг-провайдером.

---
*2023-06-07 16:00 UTC*

Из-за задержки в HackMD, этот документ был перенесен в репозиторий GitHub
https://github.com/fractureiser-investigation/fractureiser

---
*2023-06-07 14:40 UTC*

Необфусцированный этап 3 был заменен на обфусцированный, а затем на другую
полезной нагрузкой.

Эта полезная нагрузка - skyrage updater, который является известной вредоносной программой Minecraft, нацеленной на spigot
серверы.

После обслуживания skyrage на некоторое время, он снова переключился на обслуживание взломанного клиента Meteor.

(TODO эти временные рамки не совсем точны)

---
*2023-06-07 14:20 UTC*.

Анализ нового IP-адреса дал полностью деобфусцированный stage 3, похоже, загруженный случайно.
Он был заархивирован здесь: https://github.com/clrxbl/NekoClient

---
*2023-06-07 14:19 UTC*

Домен Cloudflare pages был удален.

---
*2023-06-07 14:05 UTC*

Домен Cloudflare pages переключился на новый IP-адрес, 107.189.3.101.

---


*2023-06-07 08:52 UTC*

На данный момент пыль в основном улеглась. У нас есть хорошее представление о ранних стадиях вредоносной программы, а третья стадия находится в стадии реинжиниринга. Первая стадия временно неактивна.

Мы возобновим обновления следующим утром по американскому времени (или около того).

----
*2023-06-07 08:09 UTC*.

Мы все еще работаем над реверсированием третьей стадии, технические подробности см. в разделе ниже.

----
*2023-06-07 07:37 UTC*

CurseForge опубликовал следующее заявление в своем канале #news в discord:

> Привет всем,
> 
> Мы хотели бы рассмотреть текущую ситуацию и подчеркнуть некоторые важные моменты:
> 
> * Вредоносный пользователь создал несколько учетных записей и загрузил на платформу проекты, содержащие вредоносное ПО.
> * Отдельно был взломан пользователь, принадлежащий Luna Pixel Studios (LPS), который использовался для загрузки аналогичного вредоносного ПО.
> * Мы запретили все аккаунты, имеющие отношение к этому, а также отключили аккаунт LPS. Мы поддерживаем прямой контакт с командой LPS, чтобы помочь им восстановить доступ.
> * В настоящее время мы проверяем ВСЕ новые проекты и файлы, чтобы гарантировать вашу безопасность. Разумеется, мы <u>задерживаем процесс утверждения всех новых файлов, пока эта проблема не будет решена</u>.
> * Удаление вашего CF клиента не рекомендуется, так как это не решит проблему и не позволит нам развернуть исправление. Мы работаем над инструментом, который поможет вам убедиться, что вы не были подвержены этому. Тем временем обратитесь к информации, опубликованной в #current-issues.
> * Это относится ТОЛЬКО к пользователям Minecraft.
> * Для ясности **CurseForge не взломан! Ни одна учетная запись администратора не была взломана**.
>
> > Мы работаем над этим, чтобы убедиться, что платформа остается безопасным местом для загрузки и обмена модами. Спасибо всем авторам и пользователям, которые помогают нам с выделением, мы ценим ваше сотрудничество и терпение ❤️ 
>
> Следите за обновлениями, и мы решим эту проблему.

----
*2023-06-07 07:24 UTC*.

Darkhax связался с представителями Curseforge, которые подтвердили, что затронутые файлы были загружены через пользовательский интерфейс, а не через API.

Curseforge приостановил одобрение загрузок, пока эта ситуация развивается, и удалил многие зараженные файлы.

Они также изучают IP-адреса тех, кто загрузил вредоносные файлы, чтобы выяснить, совпадают ли они с предыдущими запросами законных владельцев аккаунтов.

----
*2023-06-07 7:03 UTC*.

Мы считаем, что обнаружили истинную функцию Stage3 (`client.jar`) и пытаемся задокументировать ее здесь. Это нехорошо, друзья.

Краткая версия, пока мы приводим документ в порядок: client.jar ищет *всей файловой системе* файлы, похожие на mod jars, и заражает их Stage0. Это включает *все кэши Gradle и Maven*, а также тонны вещей, которые разработчики модов, скорее всего, никогда не подумают проверить. Потенциальный масштаб и охват этой инфекции увеличился с "пары странных модов" до *потенциально бесконечного*.

Мы считаем, что именно так инфекция распространялась изначально, и Curseforge, возможно, не был первоначальным вектором атаки.

----

*2023-06-07 6:27 UTC*

Расследование замедлилось, и большая часть команды ложится спать. unascribed открыл почтовый ящик для людей, которые могут прислать образцы или другую полезную информацию. williewillus в настоящее время работает над очисткой и включением информации, представленной D3SL, в этот документ.

----

*2023-06-07 6:20 UTC*

D3SL сообщает в неофициальном Discord, что у них есть копия полной (неусеченной) версии Stage 3 `client.jar`, а также подробный анализ того, что делает вредоносная программа. Они впервые заметили это несколько недель назад и провели углубленный анализ, в результате чего смогли получить полные копии всех полезных нагрузок.

----

*2023-06-07 5:27 UTC*.

Мы обнаружили потенциальный (усеченный) файл Stage 3; он сильно обфусцирован и содержит родную DLL полезной нагрузки, которая пытается украсть учетные данные из хранилища учетных данных Windows.

----

*2023-06-07 4:57 UTC*.

Обнаружены файлы, загруженные в апреле; либо даты подделываются, либо это происходит еще дольше. Многие аккаунты имеют время Last Active в 1999 году - вероятно, это причуда старых аккаунтов CurseForge, но все же примечательно.

Сотрудники Modrinth выясняют, не скомпрометированы ли какие-либо загрузки. Быстрый проход, который они сделали через недавно обновленные проекты, выглядит нормально.

----
    
*2023-06-07 4:40 UTC*

Масштаб этой угрозы, похоже, больше, чем предполагалось вначале. Вредоносные файлы появились несколько недель назад, еще 20 мая. Мы заметили это только сегодня, потому что они скомпрометировали популярный модпак.

---

*2023-06-07 3:38 UTC*


C&C сервер был удален провайдером. Новый, вероятно, появится, если страница Cloudflare останется на месте, мы следим за этим.

----

*2023-06-07 3:26 UTC*

Анонимный пользователь, утверждающий, что работает на серверном хосте, прислал нам возможный Stage 2 jar.

----

*2023-06-07 2:26 UTC*

Канал #cfmalware EsperNet создан для координации обсуждения, которое происходило в многочисленных гильдиях Discord и пространствах Матрицы.

----

*2023-06-07 0:40 UTC*

Команда, создавшая этот документ, узнает о вредоносных файлах, включенных в несанкционированное обновление Better Minecraft.

----

*2023-06-01 - 2023-06-04*

D3SL начинает подозревать, что вредоносные файлы потребляют процессор и оперативную память, и начинает
расследование. Порядок действий:

1. Подозрения по поводу запроса брандмауэра исполняемого файла Java приводят к его блокировке.
2. Невозможность связаться с самораспространяемыми службами приводит к тому, что в программе просмотра событий показываются все tcpip-порты
   заблокированы .
3. Netstat показывает массовое потребление портов через PID враждебного jar-файла.
4. Идентификация вредоносного javaw.exe, запускающего libwebgl64.jar, подтверждает наличие вредоносного ПО.

Отсюда Tzalumen сыграл важную роль в оказании помощи в начальной обратной разработке
байт[] обфусцированного кода и ручного перехвата полного набора файлов с удаленных сайтов.
места назначения.

Полные копии всех оригинальных файлов (включая деобфускации), кроме lib.dll, переводы
всех удаленных пунктов назначения, а также описание процесса заражения и нескольких
враждебных возможностей были предоставлены по каналам Windows Defender и
Malwarebytes. Curseforge также был уведомлен. Информация о вредоносной программе не была распространена
публично, чтобы не выдать злоумышленников.

----